#!/usr/bin/env python3
# make some .lis files for DCR in his format.
import os, glob

ds5CRanges = {
    113: [23975,23977 , 23980,24006],
    114: [24122,24122 , 24129,24141 , 24157,24158 , 24165,24174 , 24176,24181 , 24277,24280 , 24288,24302],
    115: [24334,24334 , 24339,24340 , 24440,24458 , 24468,24471],
    116: [24621,24652 , 24759,24759],
    117: [24803,24819],
    118: [24934,24953 , 24956,24966],
    119: [25224,25246 , 25277,25279],
    120: [25281,25288 , 25389,25421 , 25477,25477],
    121: [25560,25569 , 25581,25592]
}

ds6Ranges = {
    0: [25672,25673 , 25704,25792 , 25794,25831],
    1: [25936,25936],
    2: [26022,26038 , 26052,26066 , 26163,26169 , 26171,26194],
    3: [26313,26344],
    4: [26465,26496 , 26591,26622],
    5: [26742,26745],
    6: [26748,26748 , 26773,26776 , 26780,26805],
    7: [26907,26938],
    8: [27060,27091],
    9: [27217,27248],
    10: [27955,27969],
    11: [27991,28111 , 28135,28186],
    12: [28301,28320],
    13: [28345,28345 , 28391,28422],
    14: [28662,28693],
    15: [28813,28844 , 28942,28968],
    16: [28992,28997 , 29092,29106 , 29108,29124 , 29219,29250 , 29346,29354],
    17: [29378,29401 , 29498,29523],
    18: [29548,29554 , 29650,29681],
    19: [29802,29833],
    20: [29955,29986],
    21: [30105,30136 , 30232,30264],
    22: [30383,30414],
    23: [30819,30850 , 30969,30984],
    24: [30985,31002 , 31099,31105],
    25: [31127,31152 , 31249,31280],
    26: [31400,31430 , 31547,31560 , 31562,31579 , 31676,31683],
    27: [31704,31704 , 31731,31746],
    28: [31869,31886],
    29: [31888,31894],
    30: [31903,31917],
    31: [32045,32057 , 32155,32159],
    32: [32189,32191 , 32193,32208 , 32304,32327],
    33: [32485,32516 , 32618,32628 , 32647,32661 , 32848,32851],
    34: [32897,32918 , 33026,33056],
    35: [33232,33233 , 33384,33415],
    36: [33531,33563],
    37: [33682,33691],
    38: [33712,33734 , 33830,33861],
    39: [33980,34011],
    40: [34126,34157 , 34254,34269],
    41: [34289,34305 , 34402,34419 , 34424,34424],
    42: [34427,34439]
    }

def main():

    dsRanges = ds6Ranges
    rawPath = "/global/project/projectdirs/majorana/data/mjd/surfmjd/data/raw/P3LTP/Data"

    for key in sorted(dsRanges.keys()):
        subRange = dsRanges[key]
        runList = []
        for i in range(0,len(subRange),2):
            runLo, runHi = subRange[i], subRange[i+1]
            for r in range(runLo, runHi+1):
                runList.append(r)

        lisFileName = "./runLists/DS%d.lis" % subRange[0]
        print(lisFileName)
        with open(lisFileName, 'w') as lisFile:
            for run in runList:
                rawFile = glob.glob("%s/*Run%d.gz" % (rawPath, run)) # compressed
                if len(rawFile) == 0:
                    rawFile = glob.glob("%s/*Run%d" % (rawPath, run)) # uncompressed
                    if len(rawFile) == 0:
                        print("No file for run",run)
                        return
                rawFile = rawFile[0]
                rawFile = rawFile.split('/')[-1]
                print(rawFile)
                lisFile.write("%s\n" % rawFile)

if __name__=="__main__":
    main()